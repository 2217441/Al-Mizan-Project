{% extends "base.html" %}

{% block title %}Al-Mizan | The Tawhidic Knowledge Graph{% endblock %}

{% block content %}
<div class="landing-page noise-overlay">
    <!-- Animated Mesh Background -->
    <div class="mesh-background">
        <div class="mesh-blob mesh-blob--gold morph-blob"></div>
        <div class="mesh-blob mesh-blob--blue morph-blob"></div>
        <div class="mesh-blob mesh-blob--purple morph-blob"></div>
    </div>
    
    <!-- Aurora Effect -->
    <div class="aurora">
        <div class="aurora__layer"></div>
        <div class="aurora__layer"></div>
    </div>
    
    <!-- Floating Geometric Shapes -->
    <div class="geo-shape geo-shape--diamond" style="top: 15%; left: 10%;"></div>
    <div class="geo-shape geo-shape--ring" style="top: 60%; right: 8%; animation-delay: -5s;"></div>
    <div class="geo-shape geo-shape--triangle" style="bottom: 20%; left: 20%; animation-delay: -10s;"></div>
    <div class="geo-shape geo-shape--ring" style="top: 25%; right: 25%; width: 60px; height: 60px; animation-delay: -15s;"></div>

    <!-- Main Content -->
    <div class="landing-content">
        
        <!-- Hero Section -->
        <div class="hero-section">
            <div class="badge badge--status glow-pulse" style="margin-bottom: var(--space-6);">
                <span class="badge__dot"></span>
                <span>System Operational ‚Ä¢ v1.0.4 Beta</span>
            </div>
            
            <h1 class="hero-title">
                <span class="text-reveal" style="animation-delay: 0.1s;">The </span>
                <span class="text-shimmer">Tawhidic</span><br>
                <span class="text-reveal" style="animation-delay: 0.3s;">Knowledge Graph</span>
            </h1>
            
            <p class="hero-subtitle">
                Operationalizing Islamic epistemology for the AI age.<br>
                <strong>One Source of Truth. Infinite Applications.</strong>
            </p>
        </div>

        <!-- Portal Cards -->
        <div class="portal-grid stagger-reveal">
            
            <!-- Certainty Engine -->
            <a href="/" class="card card--portal card--blue gradient-border hover-lift">
                <div class="card__hover-gradient"></div>
                <div class="tilt-card__glow"></div>
                <div class="card__icon">üìñ</div>
                <h3 class="card__title">Certainty Engine</h3>
                <span class="card__tag">For Seekers (B2C)</span>
                <p class="card__desc">
                    Semantic search engine for authenticated Islamic knowledge. 
                    Verify rulings, check isnad chains, and learn with certainty.
                </p>
                <span class="card__action">
                    Launch App ‚Üí
                </span>
            </a>

            <!-- Credibility API -->
            <a href="/citadel" class="card card--portal card--green gradient-border hover-lift">
                <div class="card__hover-gradient"></div>
                <div class="tilt-card__glow"></div>
                <div class="card__icon">‚ö°</div>
                <h3 class="card__title">Credibility API</h3>
                <span class="card__tag">For Institutions (B2B)</span>
                <p class="card__desc">
                    Integrate verified knowledge into your AI models or platforms. 
                    Reputation insurance and citation analytics dashboard.
                </p>
                <span class="card__action">
                    View Dashboard ‚Üí
                </span>
            </a>

            <!-- Scholarly Console -->
            <a href="/presentation" class="card card--portal card--gold gradient-border hover-lift">
                <div class="card__hover-gradient"></div>
                <div class="tilt-card__glow"></div>
                <div class="card__icon">‚öñÔ∏è</div>
                <h3 class="card__title">Scholarly Console</h3>
                <span class="card__tag">Governance (Majlis)</span>
                <p class="card__desc">
                    Tazkiyat al-Ilm (Knowledge Curation). Human-in-the-loop 
                    verification tools for the Council of Scholars.
                </p>
                <span class="card__action">
                    Access Console üîí
                </span>
            </a>

        </div>
    </div>

    <!-- Footer Status Bar -->
    <footer class="landing-footer glass-ultra">
        <div class="landing-footer__inner">
            <div class="landing-footer__stats">
                <div class="stat">
                    <span class="stat__dot stat__dot--green"></span>
                    <span>Nodes: <span class="stat__value counter" data-target="12450">12,450</span></span>
                </div>
                <div class="stat">
                    <span class="stat__dot stat__dot--green"></span>
                    <span>Scholars: <span class="stat__value counter" data-target="840">840</span></span>
                </div>
                <div class="stat">
                    <span class="stat__dot stat__dot--blue"></span>
                    <span>Latency: <span class="stat__value">142ms</span></span>
                </div>
            </div>
            <span style="opacity: 0.6;">Al-Mizan ¬© 2026 ‚Ä¢ Tawhidic Infrastructure</span>
        </div>
    </footer>
</div>

<script>
// Stagger animation trigger on load
document.addEventListener('DOMContentLoaded', () => {
    // Text reveal animations
    document.querySelectorAll('.text-reveal').forEach((el, i) => {
        el.style.animationDelay = `${i * 0.2}s`;
    });
    
    // Cursor glow effect on cards
    document.querySelectorAll('.card--portal').forEach(card => {
        card.addEventListener('mousemove', (e) => {
            const rect = card.getBoundingClientRect();
            const x = ((e.clientX - rect.left) / rect.width) * 100;
            const y = ((e.clientY - rect.top) / rect.height) * 100;
            card.style.setProperty('--mouse-x', `${x}%`);
            card.style.setProperty('--mouse-y', `${y}%`);
        });
    });

    // Animate counters
    const counters = document.querySelectorAll('.counter');
    const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;

    if (!prefersReducedMotion && 'IntersectionObserver' in window) {
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const el = entry.target;
                    const target = parseInt(el.getAttribute('data-target'));
                    // Add comma formatting to target for final state
                    const formattedTarget = target.toLocaleString();

                    // A11y: Ensure screen readers announce the final number, not the rapid changes
                    // We set aria-label to the final value on the parent
                    if (el.parentElement) {
                        el.parentElement.setAttribute('aria-label', `${el.parentElement.textContent.split(':')[0]}: ${formattedTarget}`);
                    }
                    el.setAttribute('aria-hidden', 'true');

                    let start = 0;
                    const duration = 2000;
                    const startTime = performance.now();

                    const update = (currentTime) => {
                        const elapsed = currentTime - startTime;
                        const progress = Math.min(elapsed / duration, 1);

                        // Ease out quart
                        const ease = 1 - Math.pow(1 - progress, 4);

                        const current = Math.floor(start + (target - start) * ease);
                        el.textContent = current.toLocaleString();

                        if (progress < 1) {
                            requestAnimationFrame(update);
                        } else {
                            el.textContent = formattedTarget;
                        }
                    };

                    requestAnimationFrame(update);
                    observer.unobserve(el);
                }
            });
        }, { threshold: 0.5 });

        counters.forEach(counter => observer.observe(counter));
    }
});
</script>
{% endblock %}
